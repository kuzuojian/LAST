<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.55.5" />


<title>课堂练习 - 一个卑微的爬狗🐶</title>
<meta property="og:title" content="课堂练习 - 一个卑微的爬狗🐶">


  <link href='/favicon.ico' rel='icon' type='image/x-icon'/>



  








<link href='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



<link rel="stylesheet" href="/css/fonts.css" media="all">
<link rel="stylesheet" href="/css/main.css" media="all">



  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="/" class="nav-logo">
    <img src="/images/logo.png"
         width="50"
         height="50"
         alt="Logo">
  </a>

  <ul class="nav-links">
    
    <li><a href="www.cnki.net/">CNKI</a></li>
    
    <li><a href="https://www.csdn.net/">csdn</a></li>
    
    <li><a href="https://app.netlify.com/teams/kuzuojian/sites">netlify</a></li>
    
    <li><a href="https://github.com/kuzuojian/last/blob/master/content/post/2019-05-22-%e7%94%bb_files/figure-html/unnamed-chunk-1-1.png">地图</a></li>
    
    <li><a href="http://www.people.com.cn/">看中国</a></li>
    
    <li><a href="https://github.com/kuzuojian?tab=repositories">看看</a></li>
    
    <li><a href="http://www.huanqiu.com/?agt=15438">知世界</a></li>
    
  </ul>
</nav>

      </header>


<main class="content" role="main">

  <article class="article">
    
    <span class="article-duration">7 min read</span>
    

    <h1 class="article-title">课堂练习</h1>

    
    <span class="article-date">2019-06-05</span>
    

    <div class="article-content">
      


<pre class="r"><code>library(ggplot2)
ToothGrowth</code></pre>
<pre><code>##     len supp dose
## 1   4.2   VC  0.5
## 2  11.5   VC  0.5
## 3   7.3   VC  0.5
## 4   5.8   VC  0.5
## 5   6.4   VC  0.5
## 6  10.0   VC  0.5
## 7  11.2   VC  0.5
## 8  11.2   VC  0.5
## 9   5.2   VC  0.5
## 10  7.0   VC  0.5
## 11 16.5   VC  1.0
## 12 16.5   VC  1.0
## 13 15.2   VC  1.0
## 14 17.3   VC  1.0
## 15 22.5   VC  1.0
## 16 17.3   VC  1.0
## 17 13.6   VC  1.0
## 18 14.5   VC  1.0
## 19 18.8   VC  1.0
## 20 15.5   VC  1.0
## 21 23.6   VC  2.0
## 22 18.5   VC  2.0
## 23 33.9   VC  2.0
## 24 25.5   VC  2.0
## 25 26.4   VC  2.0
## 26 32.5   VC  2.0
## 27 26.7   VC  2.0
## 28 21.5   VC  2.0
## 29 23.3   VC  2.0
## 30 29.5   VC  2.0
## 31 15.2   OJ  0.5
## 32 21.5   OJ  0.5
## 33 17.6   OJ  0.5
## 34  9.7   OJ  0.5
## 35 14.5   OJ  0.5
## 36 10.0   OJ  0.5
## 37  8.2   OJ  0.5
## 38  9.4   OJ  0.5
## 39 16.5   OJ  0.5
## 40  9.7   OJ  0.5
## 41 19.7   OJ  1.0
## 42 23.3   OJ  1.0
## 43 23.6   OJ  1.0
## 44 26.4   OJ  1.0
## 45 20.0   OJ  1.0
## 46 25.2   OJ  1.0
## 47 25.8   OJ  1.0
## 48 21.2   OJ  1.0
## 49 14.5   OJ  1.0
## 50 27.3   OJ  1.0
## 51 25.5   OJ  2.0
## 52 26.4   OJ  2.0
## 53 22.4   OJ  2.0
## 54 24.5   OJ  2.0
## 55 24.8   OJ  2.0
## 56 30.9   OJ  2.0
## 57 26.4   OJ  2.0
## 58 27.3   OJ  2.0
## 59 29.4   OJ  2.0
## 60 23.0   OJ  2.0</code></pre>
<pre class="r"><code>head(ToothGrowth)</code></pre>
<pre><code>##    len supp dose
## 1  4.2   VC  0.5
## 2 11.5   VC  0.5
## 3  7.3   VC  0.5
## 4  5.8   VC  0.5
## 5  6.4   VC  0.5
## 6 10.0   VC  0.5</code></pre>
<p>这是芽的生长</p>
<pre class="r"><code>library(ggplot2)
ToothGrowth</code></pre>
<pre><code>##     len supp dose
## 1   4.2   VC  0.5
## 2  11.5   VC  0.5
## 3   7.3   VC  0.5
## 4   5.8   VC  0.5
## 5   6.4   VC  0.5
## 6  10.0   VC  0.5
## 7  11.2   VC  0.5
## 8  11.2   VC  0.5
## 9   5.2   VC  0.5
## 10  7.0   VC  0.5
## 11 16.5   VC  1.0
## 12 16.5   VC  1.0
## 13 15.2   VC  1.0
## 14 17.3   VC  1.0
## 15 22.5   VC  1.0
## 16 17.3   VC  1.0
## 17 13.6   VC  1.0
## 18 14.5   VC  1.0
## 19 18.8   VC  1.0
## 20 15.5   VC  1.0
## 21 23.6   VC  2.0
## 22 18.5   VC  2.0
## 23 33.9   VC  2.0
## 24 25.5   VC  2.0
## 25 26.4   VC  2.0
## 26 32.5   VC  2.0
## 27 26.7   VC  2.0
## 28 21.5   VC  2.0
## 29 23.3   VC  2.0
## 30 29.5   VC  2.0
## 31 15.2   OJ  0.5
## 32 21.5   OJ  0.5
## 33 17.6   OJ  0.5
## 34  9.7   OJ  0.5
## 35 14.5   OJ  0.5
## 36 10.0   OJ  0.5
## 37  8.2   OJ  0.5
## 38  9.4   OJ  0.5
## 39 16.5   OJ  0.5
## 40  9.7   OJ  0.5
## 41 19.7   OJ  1.0
## 42 23.3   OJ  1.0
## 43 23.6   OJ  1.0
## 44 26.4   OJ  1.0
## 45 20.0   OJ  1.0
## 46 25.2   OJ  1.0
## 47 25.8   OJ  1.0
## 48 21.2   OJ  1.0
## 49 14.5   OJ  1.0
## 50 27.3   OJ  1.0
## 51 25.5   OJ  2.0
## 52 26.4   OJ  2.0
## 53 22.4   OJ  2.0
## 54 24.5   OJ  2.0
## 55 24.8   OJ  2.0
## 56 30.9   OJ  2.0
## 57 26.4   OJ  2.0
## 58 27.3   OJ  2.0
## 59 29.4   OJ  2.0
## 60 23.0   OJ  2.0</code></pre>
<pre class="r"><code>head(ToothGrowth)</code></pre>
<pre><code>##    len supp dose
## 1  4.2   VC  0.5
## 2 11.5   VC  0.5
## 3  7.3   VC  0.5
## 4  5.8   VC  0.5
## 5  6.4   VC  0.5
## 6 10.0   VC  0.5</code></pre>
<pre class="r"><code>g &lt;-ggplot(ToothGrowth,aes(x=dose,y=len))
g</code></pre>
<p><img src="/post/2019-06-05-课堂练习_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>g +geom_boxplot(aes(color=dose))</code></pre>
<pre><code>## Warning: Continuous x aesthetic -- did you forget aes(group=...)?</code></pre>
<p><img src="/post/2019-06-05-课堂练习_files/figure-html/unnamed-chunk-2-2.png" width="672" />
color是边际改变，fill是里面的改变即填充
fill=supp根据供应商分类</p>
<pre class="r"><code>library(ggplot2)
g + geom_jitter(position=position_jitter(0.2)) + 
  stat_summary(fun.data=&quot;mean_sdl&quot;,  fun.args = list(mult=1), 
               geom=&quot;pointrange&quot;, color = &quot;red&quot;)</code></pre>
<p><img src="/post/2019-06-05-课堂练习_files/figure-html/unnamed-chunk-3-1.png" width="672" />
stack叠加
fun.data=“mean_sdl”计算中间值
dose计量，不同的计量有不同的颜色
factor分类，在灵魂里穿衣服
color 或者factor在身体上穿衣服
geom point(color=“red”)实际显示的内容
颜色会覆盖，ggplot(data,aes(x,y,color,fill))
对数据求标准差，fun,是function,fun.data=“mean_sdl”
position=position_jitter(0.2)位置的偏移</p>
<pre class="r"><code>library(ggplot2)
ggplot(diamonds, aes(cut, color)) +
  geom_jitter(aes(color = cut), size = 0.5)</code></pre>
<p><img src="/post/2019-06-05-课堂练习_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>library(ggplot2)
df &lt;- ToothGrowth
df$dose &lt;- as.factor(df$dose)
head(df)</code></pre>
<pre><code>##    len supp dose
## 1  4.2   VC  0.5
## 2 11.5   VC  0.5
## 3  7.3   VC  0.5
## 4  5.8   VC  0.5
## 5  6.4   VC  0.5
## 6 10.0   VC  0.5</code></pre>
<pre class="r"><code>data_summary &lt;- function(data, varname, grps){
  require(plyr)
  summary_func &lt;- function(x, col){
    c(mean = mean(x[[col]], na.rm=TRUE),
      sd = sd(x[[col]], na.rm=TRUE))
  }
  data_sum&lt;-ddply(data, grps, .fun=summary_func, varname)
  data_sum &lt;- rename(data_sum, c(&quot;mean&quot; = varname))
 return(data_sum)
}
df2 &lt;- data_summary(df, varname=&quot;len&quot;, grps= &quot;dose&quot;)</code></pre>
<pre><code>## 载入需要的程辑包：plyr</code></pre>
<pre class="r"><code># Convert dose to a factor variable
df2$dose=as.factor(df2$dose)
head(df2)</code></pre>
<pre><code>##   dose    len       sd
## 1  0.5 10.605 4.499763
## 2    1 19.735 4.415436
## 3    2 26.100 3.774150</code></pre>
<pre class="r"><code>f &lt;- ggplot(df2, aes(x = dose, y = len, 
                     ymin = len-sd, ymax = len+sd))
f+geom_crossbar()</code></pre>
<p><img src="/post/2019-06-05-课堂练习_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code>f+geom_crossbar(aes(color=dose))</code></pre>
<p><img src="/post/2019-06-05-课堂练习_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
<pre class="r"><code>f+geom_crossbar(aes(color=dose))+
  scale_color_manual(values = c(&quot;#999999&quot;, &quot;#E69F00&quot;, &quot;#56B4E9&quot;))+theme_classic()</code></pre>
<p><img src="/post/2019-06-05-课堂练习_files/figure-html/unnamed-chunk-5-3.png" width="672" /></p>
<pre class="r"><code>f &lt;- ggplot(df, aes(x=dose, y=len, color=supp))
f+stat_summary(fun.data = mean_sdl, fun.args = list(mult=1), geom=&quot;crossbar&quot;, width=0.6, position = position_dodge(0.8))</code></pre>
<p><img src="/post/2019-06-05-课堂练习_files/figure-html/unnamed-chunk-5-4.png" width="672" /></p>
<p>as factor再次确认一次
数字变成factor不可以加减，而是分类不再是0.5+0.5=1，而是二因为是两种分类
要编一个函数
gata_summary对象名,function 是运作,
data_summary &lt;- function(data, varname, grps){
require(plyr)
ddply(data, grps, .fun=summary_func, varname)是循环
ymin就是标准差
f+geom_crossbar()空心树，这只是展示方式
scale自定义</p>
<p>透明的scalebrewer颜色的排序，红橙黄绿，gradient渐变</p>
<p>scaler颜色的梯度
scale fill实心颜色
linetype cont线性</p>
<p>errorbar标准差</p>
<pre class="r"><code>library(ggplot2)
library(maps)</code></pre>
<pre><code>## 
## 载入程辑包：&#39;maps&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:plyr&#39;:
## 
##     ozone</code></pre>
<pre class="r"><code>head(USArrests)</code></pre>
<pre><code>##            Murder Assault UrbanPop Rape
## Alabama      13.2     236       58 21.2
## Alaska       10.0     263       48 44.5
## Arizona       8.1     294       80 31.0
## Arkansas      8.8     190       50 19.5
## California    9.0     276       91 40.6
## Colorado      7.9     204       78 38.7</code></pre>
<pre class="r"><code>crimes &lt;- data.frame(state=tolower(rownames(USArrests)), USArrests)
head(crimes)</code></pre>
<pre><code>##                 state Murder Assault UrbanPop Rape
## Alabama       alabama   13.2     236       58 21.2
## Alaska         alaska   10.0     263       48 44.5
## Arizona       arizona    8.1     294       80 31.0
## Arkansas     arkansas    8.8     190       50 19.5
## California california    9.0     276       91 40.6
## Colorado     colorado    7.9     204       78 38.7</code></pre>
<pre class="r"><code>library(reshape2)
crimesm &lt;- melt(crimes, id=1)
head(crimesm)</code></pre>
<pre><code>##        state variable value
## 1    alabama   Murder  13.2
## 2     alaska   Murder  10.0
## 3    arizona   Murder   8.1
## 4   arkansas   Murder   8.8
## 5 california   Murder   9.0
## 6   colorado   Murder   7.9</code></pre>
<pre class="r"><code>map_data &lt;- map_data(&quot;state&quot;)
#绘制地图，使用Murder进行着色
ggplot(crimes, aes(map_id=state))+
  geom_map(aes(fill=Murder), map=map_data)+
  expand_limits(x=map_data$long, y=map_data$lat)</code></pre>
<p><img src="/post/2019-06-05-课堂练习_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>reshape2数据转换，melt多页变两页</p>
<pre class="r"><code>library(ggplot2)
df &lt;- data.frame(dose=c(&quot;D0.5&quot;, &quot;D1&quot;, &quot;D2&quot;),
                len=c(4.2, 10, 29.5))
head(df)</code></pre>
<pre><code>##   dose  len
## 1 D0.5  4.2
## 2   D1 10.0
## 3   D2 29.5</code></pre>
<pre class="r"><code>df &lt;- data.frame(supp=rep(c(&quot;VC&quot;, &quot;OJ&quot;), each=3),
                dose=rep(c(&quot;D0.5&quot;, &quot;D1&quot;, &quot;D2&quot;),2),
                len=c(6.8, 15, 33, 4.2, 10, 29.5))
head(df)</code></pre>
<pre><code>##   supp dose  len
## 1   VC D0.5  6.8
## 2   VC   D1 15.0
## 3   VC   D2 33.0
## 4   OJ D0.5  4.2
## 5   OJ   D1 10.0
## 6   OJ   D2 29.5</code></pre>
<pre class="r"><code>f &lt;- ggplot(df, aes(x = dose, y = len))
f + geom_bar(stat = &quot;identity&quot;)</code></pre>
<p><img src="/post/2019-06-05-课堂练习_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code>f + geom_bar(stat=&quot;identity&quot;,fill=&quot;steelblue&quot;)+geom_text(aes(label=len),vjust=-4, hjust=-8,size=3.5)+theme_minimal()</code></pre>
<p><img src="/post/2019-06-05-课堂练习_files/figure-html/unnamed-chunk-7-2.png" width="672" /></p>
<pre class="r"><code>f + geom_bar(aes(color = dose),
             stat=&quot;identity&quot;, fill=&quot;white&quot;)</code></pre>
<p><img src="/post/2019-06-05-课堂练习_files/figure-html/unnamed-chunk-7-3.png" width="672" /></p>
<pre class="r"><code>f + geom_bar(aes(fill = dose), stat=&quot;identity&quot;)</code></pre>
<p><img src="/post/2019-06-05-课堂练习_files/figure-html/unnamed-chunk-7-4.png" width="672" />
vjust垂直调整，负的是向上
hjust负是向右</p>
<pre class="r"><code>library(ggplot2)
df &lt;- data.frame(supp=rep(c(&quot;VC&quot;, &quot;OJ&quot;), each=3),
                dose=rep(c(&quot;D0.5&quot;, &quot;D1&quot;, &quot;D2&quot;),2),
                len=c(6.8, 15, 33, 4.2, 10, 29.5))
head(df)</code></pre>
<pre><code>##   supp dose  len
## 1   VC D0.5  6.8
## 2   VC   D1 15.0
## 3   VC   D2 33.0
## 4   OJ D0.5  4.2
## 5   OJ   D1 10.0
## 6   OJ   D2 29.5</code></pre>
<pre class="r"><code>ggplot(df, aes(x=dose, y=len, group=supp)) +
  geom_line(aes(linetype=supp))+
  geom_point()</code></pre>
<p><img src="/post/2019-06-05-课堂练习_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code>ggplot(df, aes(x=dose, y=len, group=supp)) +geom_line(aes(linetype=supp, color = supp))+geom_point(aes(shape=supp, color = supp))</code></pre>
<p><img src="/post/2019-06-05-课堂练习_files/figure-html/unnamed-chunk-8-2.png" width="672" />
geom_point(color=“red”)</p>
<p>geom_point(aes(shape=supp, color = supp))可以因子分类统计</p>
<pre class="r"><code>library(ggplot2)
ToothGrowth$dose &lt;- as.factor(ToothGrowth$dose)
head(ToothGrowth)</code></pre>
<pre><code>##    len supp dose
## 1  4.2   VC  0.5
## 2 11.5   VC  0.5
## 3  7.3   VC  0.5
## 4  5.8   VC  0.5
## 5  6.4   VC  0.5
## 6 10.0   VC  0.5</code></pre>
<pre class="r"><code>e &lt;- ggplot(data = ToothGrowth, aes(x=dose, y=len))
e + geom_jitter(position=position_jitter(0.2))</code></pre>
<p><img src="/post/2019-06-05-课堂练习_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>e + geom_jitter(position=position_jitter(0.2)) + 
  geom_dotplot(binaxis = &quot;y&quot;, stackdir = &quot;center&quot;) </code></pre>
<pre><code>## `stat_bindot()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="/post/2019-06-05-课堂练习_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<pre class="r"><code>ToothGrowth$dose &lt;- as.factor(ToothGrowth$dose)
head(ToothGrowth)</code></pre>
<pre><code>##    len supp dose
## 1  4.2   VC  0.5
## 2 11.5   VC  0.5
## 3  7.3   VC  0.5
## 4  5.8   VC  0.5
## 5  6.4   VC  0.5
## 6 10.0   VC  0.5</code></pre>
<pre class="r"><code>f &lt;-ggplot(data = ToothGrowth, aes(x=dose, y=len))
f + geom_jitter(position=position_jitter(0.2)) + stat_summary(fun.data=&quot;mean_sdl&quot;,  fun.args =list(mult=1),geom=&quot;pointrange&quot;, color = &quot;red&quot;)</code></pre>
<p><img src="/post/2019-06-05-课堂练习_files/figure-html/unnamed-chunk-9-3.png" width="672" /></p>
<pre class="r"><code>f + geom_dotplot(binaxis = &quot;y&quot;, stackdir = &quot;center&quot;) </code></pre>
<pre><code>## `stat_bindot()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="/post/2019-06-05-课堂练习_files/figure-html/unnamed-chunk-9-4.png" width="672" />
rep重复三次</p>
<pre class="r"><code>library(ggplot2)
df &lt;- data.frame(supp=rep(c(&quot;VC&quot;, &quot;OJ&quot;), each=3),
                dose=rep(c(&quot;D0.5&quot;, &quot;D1&quot;, &quot;D2&quot;),2),
                len=c(6.8, 15, 33, 4.2, 10, 29.5))
head(df)</code></pre>
<pre><code>##   supp dose  len
## 1   VC D0.5  6.8
## 2   VC   D1 15.0
## 3   VC   D2 33.0
## 4   OJ D0.5  4.2
## 5   OJ   D1 10.0
## 6   OJ   D2 29.5</code></pre>
<pre class="r"><code>ggplot(df, aes(x=dose, y=len, group=supp)) +
  geom_line(aes(linetype=supp))+
  geom_point()</code></pre>
<p><img src="/post/2019-06-05-课堂练习_files/figure-html/unnamed-chunk-10-1.png" width="672" />
huozhe</p>
<pre class="r"><code>library(ggplot2)
f &lt;-ggplot(df, aes(x=dose, y=len, group=supp))
f+geom_line(aes(linetype=supp))</code></pre>
<p><img src="/post/2019-06-05-课堂练习_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code>f+ geom_point()</code></pre>
<p><img src="/post/2019-06-05-课堂练习_files/figure-html/unnamed-chunk-11-2.png" width="672" />
linetype=supp给线分类</p>

    </div>
  </article>

  


</main>

      <footer class="footer">
        <ul class="footer-links">
          <li>
            <a href="/index.xml" type="application/rss+xml" target="_blank">RSS feed</a>
          </li>
          <li>
            <a href="https://gohugo.io/" class="footer-links-kudos">Made with <img src="/images/hugo-logo.png" alt="Img link to Hugo website" width="22" height="22"></a>
          </li>
        </ul>
      </footer>

    </div>
    



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



    
<script src="/js/math-code.js"></script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
  </body>
</html>

